"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.buildRequestChecks = exports.buildRequestDeletes = exports.buildRequestSet = void 0;
const errors_1 = require("../errors");
function buildConditionsRequest(filter) {
    if (!filter) {
        return undefined;
    }
    if (filter.filters().length === 0) {
        throw new errors_1.ForgeKvsError('Builder must have at least one condition set');
    }
    return {
        [filter.operator()]: filter.filters()
    };
}
const buildRequestSet = (setOperation) => {
    const { key, value, entity } = setOperation;
    const entityName = entity?.entityName;
    const conditions = buildConditionsRequest(entity?.conditions);
    return {
        key,
        value,
        entityName,
        conditions
    };
};
exports.buildRequestSet = buildRequestSet;
const buildRequestDeletes = (deleteOperation) => {
    const { key, entity } = deleteOperation;
    const entityName = entity?.entityName;
    const conditions = buildConditionsRequest(entity?.conditions);
    return {
        key,
        entityName,
        conditions
    };
};
exports.buildRequestDeletes = buildRequestDeletes;
const buildRequestChecks = (checkOperation) => {
    const { key, entity } = checkOperation;
    const entityName = entity.entityName;
    const conditions = buildConditionsRequest(entity.conditions);
    return {
        key,
        entityName,
        conditions
    };
};
exports.buildRequestChecks = buildRequestChecks;
